setwd("~/Documents/Formación/visualizacion/code")
# Incluimos los paquetes necesarios
library(dplyr)
# Leemos el set de datos
weather <- read.table('./data/weather-madrid.txt')
nrow(weather)
str(weather)
head(weather)
unique(weather$V1)
unique(weather$V2)
unique(weather$V3)
colnames(weather) <- c('month', 'day', 'year', 'temp')
table(weather$year)
weather <- weather[weather$year < 2015,]
table(weather$day)
table(weather$month)
summary(weather$temp)
boxplot(weather$temp)
sum(weather$temp < 0)
sum(weather$temp < 0) / nrow(weather)
weather <- weather[weather$temp > 0, ]
weather$temp <- (weather$temp - 32) / 1.8
summary(weather$temp)
nrow(weather)
str(weather)
head(weather)
unique(weather$V1)
unique(weather$V2)
unique(weather$V3)
colnames(weather) <- c('month', 'day', 'year', 'temp')
table(weather$year)
unique(weather$V1)
unique(weather$V2)
head(weather)
weather <- read.table('./data/weather-madrid.txt')
weather
nrow(weather)
str(weather)
head(weather)
unique(weather$V1)
unique(weather$V2)
unique(weather$V3)
colnames(weather) <- c('month', 'day', 'year', 'temp')
table(weather$year)
weather <- weather[weather$year < 2015,]
table(weather$day)
table(weather$month)
summary(weather$temp)
boxplot(weather$temp)
sum(weather$temp < 0)
sum(weather$temp < 0) / nrow(weather)
weather <- weather[weather$temp > 0, ]
weather$temp <- (weather$temp - 32) / 1.8
summary(weather$temp)
past <- weather %>%
filter(year < 2014) %>%
arrange(year, month, day) %>%
group_by(year) %>%
mutate(year.day = seq(1, length(day))) %>%
group_by(year.day) %>%
summarise(min = min(temp),
max = max(temp),
mean_inf = mean(temp) - qt(0.975, 2013 - 1995) * sd(temp) / sqrt(n()),
mean_sup = mean(temp) + qt(0.975, 2013 - 1995) * sd(temp) / sqrt(n())) %>%
as.data.frame()
present <- weather %>%
filter(year == 2014) %>%
arrange(year, month, day) %>%
mutate(year.day = seq(1, length(day))) %>%
select(year.day, temp)
present.highs <- present %>%
left_join(past, by = "year.day") %>%
mutate(is.higher = ifelse(temp > max, "Y", "N")) %>%
filter(is.higher == "Y") %>%
select(year.day, temp)
present.lows <- present %>%
left_join(past, by = "year.day") %>%
mutate(is.lower = ifelse(temp < min, "Y", "N")) %>%
filter(is.lower == "Y") %>%
select(year.day, temp)
library(ggplot2)
library(tidyr)
ggplot(present, aes(x = year.day, y = temp)) +
geom_line()
ggplot(present, aes(x = year.day, y = temp)) +
geom_line(aes(col = temp)) +
scale_color_gradient2(low = "blue", high = "red", mid = "white", midpoint = 15)
ggplot(present, aes(x = year.day, y = temp)) +
geom_line(alpha = 0.5, linetype="dotted") +
geom_point(aes(col = temp), size = 1) +
scale_color_gradient2(low = "blue", high = "red", mid = "white", midpoint = 15) +
geom_point(col = "black", shape = 1, alpha = 0.5)
ggplot(present, aes(x = year.day, y = temp)) +
geom_line(alpha = 0.5, linetype="dotted") +
geom_point(aes(col = temp, size=temp)) +
scale_color_gradient2(low = "blue", high = "red", mid = "white", midpoint = 15) +
geom_point(aes(size=temp), col = "black", shape = 1, alpha = 0.5) +
scale_y_continuous(limits = c(0, 15)) +
scale_size_continuous(range = c(1, 5))
library(ggplot2)
ggplot(past, aes(x = year.day, ymin = min, ymax = max)) +
geom_linerange(col = "wheat")
ggplot(past, aes(x = year.day, ymin = mean_inf, ymax = mean_sup)) +
geom_linerange(col = "wheat4")
ggplot(present, aes(x = year.day, y = temp)) +
geom_line(size = 0.3)
ggplot(present.highs, aes(x = year.day, y = temp)) +
geom_point(col = "firebrick3", size = 1)
ggplot(present.lows, aes(x = year.day, y = temp)) +
geom_point(col = "blue3", size=1)
ggplot() +
geom_linerange(data = past, aes(x = year.day, ymin = min, ymax = max), col = "wheat") +
geom_linerange(data = past, aes(x = year.day, ymin = mean_inf, ymax = mean_sup), col = "wheat4") +
geom_line(data = present, aes(x = year.day, y = temp), size = 0.3) +
geom_point(data = present.highs, aes(x = year.day, y = temp), col = "firebrick3", size = 1) +
geom_point(data = present.lows, aes(x = year.day, y = temp), col = "blue3", size=1)
y.values <- seq(-5, 55, 5)
y.labels <- sapply(y.values, function(x) { paste0(as.character(x), 'º') })
x.values <- seq(15, 365, 30)
x.labels <- c("Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul", "Ago", "Sep", "Oct", "Nov", "Dic")
ggplot() +
geom_linerange(data = past, aes(x = year.day, ymin = min, ymax = max), col = "wheat") +
geom_linerange(data = past, aes(x = year.day, ymin = mean_inf, ymax = mean_sup), col = "wheat4") +
geom_line(data = present, aes(x = year.day, y = temp), size = 0.3) +
geom_point(data = present.highs, aes(x = year.day, y = temp), col = "firebrick3", size = 1) +
geom_point(data = present.lows, aes(x = year.day, y = temp), col = "blue3", size=1) +
scale_y_continuous(breaks = y.values, labels = y.labels, name = "", expand = c(0, 0)) +
scale_x_continuous(breaks = x.values, labels = x.labels, name = "", expand = c(0, 0))
