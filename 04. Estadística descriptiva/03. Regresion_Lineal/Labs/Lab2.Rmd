---
title: "Lab2 - Instrucciones para ajustar modelos lineales múltiples R"
author: "J. Ramón Sánchez Leo"
date: "19/12/2021"
output: html_document
---

### **<span style="color:#d84519">Afi Escuela - MDS & MDSF</span>**

La instrucción para ajustar un modelo lineal en R es ``lm``:

``lm(formula, data, subset, weights, ...)``

donde 

- ``formula`` es una descripción simbólica del modelo que se pretende ajustar.
- ``data`` es un <i>data frame</i> que contiene los datos con los que se pretende ajustar el modelo.
- ``subset`` es un vector opcional que especifica el subconjunto de observaciones que se van a usar en el proceso de ajuste.
- ``weights`` es un vector opcional de pesos que se van a usar en el proceso de ajuste del modelo. Por defecto ``weights=NULL``, indicando que el ajuste se realizará por mínimos cuadrados ordinarios, y, en caso contrario, si se pasa un vector $w = (w_1, \dots, w_n)$, la función que se minimiza en el ajuste del modelo es el $MSE$ ponderado por $W$, es decir,
$$
MSE_w = \sum_{i=1}^{n} w_i e_i^2.
$$

### El dataset Advertising

```{r, warning=FALSE, message=FALSE}
library(dplyr)
advertising <- read.csv('advertising.csv', sep = ';', header = T, fileEncoding = 'utf-8')
glimpse(advertising)
```

# **<span style="color:#d84519">Ajuste de un modelo lineal múltiple</span>**

Para ajustar un modelo de regresión lineal múltiple, la instrucción que se emplea es la misma que en el caso univariante, pero en la fórmula se han de especificar todas las variables que se pretenden considerar, separadas por un ``+``. Así, para ajustar un modelo de ``Sales`` frente a ``TV``, ``Radio`` y ``Newspaper`` hacemos

```{r}
lm_fit_sales_all <- lm(Sales ~ TV + Radio + Newspaper, data = advertising)
summary(lm_fit_sales_all)
```

El modelo que se obtiene es

$$
Sales = 2.938889 + 0.045765\cdot TV + 0.188530 \cdot Radio - 0.001037 \cdot Newspaper
$$

Una llamada equivalente a la que hemos hecho sería 
```{r}
lm_fit_sales_all <- lm(Sales ~ ., data = advertising)
```
ya que el punto quiere decir "todas las demás variables". Si quieren quitarse variables, se utiliza un ``-``. Así, una forma de ajustar un modelo de ``Sales`` frente a ``TV`` y ``Radio`` sería
```{r}
lm_fit_sales_TV_Radio <- lm(Sales ~ . - Newspaper, data = advertising)
```


```{r}
summary(lm_fit_sales_TV_Radio)
```


