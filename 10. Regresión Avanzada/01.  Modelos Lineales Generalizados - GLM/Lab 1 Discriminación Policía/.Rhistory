# Chunk 1: global_options
knitr::opts_chunk$set(echo = T, warning=FALSE, message=FALSE)
# Chunk 2
htmltools::img(src = knitr::image_uri(file.path("AfiLogo.jpg")),
alt = 'logo',
style = 'position:absolute; top:0; right:0; padding:10px;',
width="173",
height="77")
# Chunk 3
# delete everything
rm(list=ls())
library(tidyverse)
library(effects)
# Chunk 4
data(Arrests)
head(Arrests)
# Chunk 5
# Summarize the target variable here
# Chunk 6
# Categorical vs numerical
Arrests %>%
ggplot(aes(x = released, y = age)) +
geom_boxplot(fill="lightblue") +
labs(title = "Released by age", x = "", y = "", col = "")
# Chunk 7
# Categorical vs categorical
# Plot the relation between the target and race here
# Chunk 8
# Categorical vs categorical
Arrests %>%
ggplot(aes(x= released, fill = sex)) + geom_bar() +
labs(title = "Released by sex", x = "", y = "", col = "")
# Chunk 9
# Categorical vs numerical
Arrests %>%
ggplot(aes(x = released, y = checks)) +
geom_boxplot(fill="lightblue") +
labs(title = "Released by previous checks", x = "", y = "", col = "")
# Chunk 11
arrests.mod <- glm(released ~ colour*age, family=binomial(link="logit"), data=Arrests)
summary(arrests.mod)
# Chunk 12
plot(effect("colour", arrests.mod), ci.style="band", rescale.axis=FALSE, multiline=TRUE, ylab="P(released)", rug=FALSE, main="")
# Chunk 13
plot(effect("age", arrests.mod), ci.style="band", rescale.axis=FALSE, multiline=TRUE, ylab="P(released)", rug=FALSE, main="")
# Chunk 14
plot(effect("colour:age", arrests.mod), ci.style="band", rescale.axis=FALSE, multiline=TRUE, ylab="P(released)", rug=FALSE, main="")
# Chunk 15
summary(arrests.mod)
# Chunk 16
confint(arrests.mod)
# Chunk 17
exp(confint(arrests.mod))
# Chunk 18
arrests.mod <- glm(released ~ employed + citizen + checks + colour*year + colour*age, family=binomial, data=Arrests)
summary(arrests.mod)
# Chunk 19
plot(effect("colour", arrests.mod), ci.style="band", rescale.axis=FALSE, multiline=TRUE, ylab="P(released)", rug=FALSE, main="")
# Chunk 20
plot(effect("employed", arrests.mod), ci.style="band", rescale.axis=FALSE, multiline=TRUE, ylab="P(released)", rug=FALSE, main="")
# Chunk 21
plot(effect("citizen", arrests.mod), ci.style="band", rescale.axis=FALSE, multiline=TRUE, ylab="P(released)", rug=FALSE, main="")
# Chunk 22
plot(effect("checks", arrests.mod), ci.style="band", rescale.axis=FALSE, multiline=TRUE, ylab="P(released)", rug=FALSE, main="")
# Chunk 23
plot(effect("colour:age", arrests.mod), ci.style="band", rescale.axis=FALSE, multiline=TRUE, ylab="P(released)", rug=FALSE, main="")
# Chunk 24
plot(effect("colour:year", arrests.mod), ci.style="band", rescale.axis=FALSE, multiline=TRUE, ylab="P(released)", rug=FALSE, main="")
# Chunk 25
plot(allEffects(arrests.mod), ci.style="band", rescale.axis=FALSE, multiline=TRUE, ylab="P(released)", rug=FALSE, main="")
# Chunk 26
new.obs = data.frame(colour="Black", age=40, employed="No", citizen="No", checks=2, year=2002)
predict(arrests.mod, newdata=new.obs, type = "response")
# Chunk 27
# Change here any value in predictors and see what happens
# Chunk 28
preds = predict(arrests.mod, newdata=new.obs, type = "link", se.fit=T)
critval <- 1.96 ## approx 95% CI
upr <- preds$fit + (critval * preds$se.fit)
lwr <- preds$fit - (critval * preds$se.fit)
fit <- preds$fit
fit
# Chunk 29
fit2 <- arrests.mod$family$linkinv(fit)
upr2 <- arrests.mod$family$linkinv(upr)
lwr2 <- arrests.mod$family$linkinv(lwr)
data.frame(lower=lwr2, prediction=fit2, upper=upr2)
rm(list=ls())
# delete everything
rm(list=ls())
library(tidyverse)
library(effects)
library(tidyverse)
library(effects)
# The dataset
Let's make our own analysis: our dataset is a subset of the larger data considered in the Toronto Star.
```{r}
data(Arrests)
head(Arrests)
# Summarize the target variable here
summarise(Arrests$released)
knitr::opts_chunk$set(echo = T)
data(Arrests)
head(Arrests)
knitr::opts_chunk$set(echo = T)
data(Arrests)
head(Arrests)
summarise(Arrests$released)
summary(Arrests$released)
````
```
]]
